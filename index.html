<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Text 2 Emoji â€” Encrypt / Decrypt</title>
<style>
:root {
  --bg-gradient: linear-gradient(135deg, #1f1c2c, #928dab);
  --panel-bg: rgba(255, 255, 255, 0.05);
  --panel-blur: blur(12px);
  --text-color: #ffffff;
  --muted-color: rgba(255,255,255,0.7);
  --accent-gradient: linear-gradient(135deg, #6a11cb, #2575fc);
  --error-bg: rgba(255, 80, 80, 0.15);
  --error-text: #ff8080;
  --border-radius: 14px;
  --transition: 0.3s ease;
}

body.light {
  --bg-gradient: linear-gradient(135deg, #f0f2f5, #d0d4db);
  --panel-bg: rgba(0, 0, 0, 0.05);
  --text-color: #111111;
  --muted-color: rgba(0,0,0,0.5);
  --error-text: #d63031;
}

*{box-sizing:border-box;font-family:'Inter',system-ui,sans-serif;}
html,body{height:100%;margin:0;background:var(--bg-gradient);color:var(--text-color);transition:background 0.5s ease,color 0.5s ease;}
.wrap{max-width:880px;margin:48px auto;padding:32px;text-align:center;}
h1{font-size:52px;font-weight:700;letter-spacing:-1px;margin:20px 0;text-shadow:0 2px 8px rgba(0,0,0,0.3);}

/* Mode buttons */
.controls .seg{background:var(--panel-bg);backdrop-filter:var(--panel-blur);
border-radius:var(--border-radius);padding:8px;display:inline-flex;gap:8px;margin-bottom:16px;}
.seg button{background:transparent;border:0;color:var(--muted-color);padding:10px 20px;border-radius:10px;cursor:pointer;transition:var(--transition);font-size:16px;}
.seg button.active{background:var(--accent-gradient);color:white;box-shadow:0 4px 14px rgba(0,0,0,0.4);font-weight:600;transform:scale(1.05);}

/* Inputs */
label{display:block;color:var(--muted-color);margin:14px 0 6px;font-size:14px;text-align:left;}
textarea,input[type=text],input[type=password]{width:100%;background:var(--panel-bg);backdrop-filter:var(--panel-blur);border:1px solid rgba(255,255,255,0.1);
padding:14px;border-radius:var(--border-radius);color:var(--text-color);resize:vertical;min-height:70px;transition:var(--transition),border-color 0.3s ease;font-size:15px;}
textarea:focus,input:focus{outline:none;border-color:#6a11cb;box-shadow:0 0 12px rgba(106,17,203,0.6);}
input.error,textarea.error{border-color:#ff4d4d !important;box-shadow:0 0 12px rgba(255,77,77,0.7) !important;}

/* Buttons */
.btn{display:inline-flex;align-items:center;justify-content:center;gap:10px;background:var(--accent-gradient);border:0;padding:12px 14px;
border-radius:var(--border-radius);color:white;cursor:pointer;width:100%;font-weight:600;transition:var(--transition);font-size:16px;}
.btn:hover{transform:scale(1.03);box-shadow:0 4px 16px rgba(0,0,0,0.4);}

/* Result */
.result{margin-top:16px;background:var(--panel-bg);backdrop-filter:var(--panel-blur);padding:14px;border-radius:var(--border-radius);
word-break:break-word;min-height:54px;font-size:15px;white-space:pre-wrap;}

/* Copy/Clear */
.copyBtn{padding:8px 12px;border-radius:10px;background:rgba(255,255,255,0.08);border:0;color:var(--muted-color);
cursor:pointer;transition:var(--transition);font-size:14px;user-select:none;}
.copyBtn:hover{color:white;background:rgba(255,255,255,0.15);}

/* Error box */
.error{margin-top:8px;padding:8px 12px;background:var(--error-bg);color:var(--error-text);
border-radius:8px;font-weight:600;font-size:14px;user-select:none;}

/* Password strength */
.password-strength{margin-top:5px;height:8px;background:#ddd;border-radius:8px;overflow:hidden;}
.password-strength-bar{height:100%;width:0%;transition:width 0.3s ease,background-color 0.3s ease;}
.strength-text{text-align:left;font-size:12px;margin-top:3px;color:var(--muted-color);}

/* Share buttons */
.share-section{margin-top:14px;display:flex;justify-content:center;gap:16px;}
.share-section button{background:transparent;border:none;cursor:pointer;font-size:26px;color:var(--muted-color);transition:color 0.3s ease;}
.share-section button:hover{color:#6a11cb;}

/* Footer */
footer{margin-top:24px;color:var(--muted-color);font-size:14px;text-align:center;padding:10px 0;border-top:1px solid rgba(255,255,255,0.1);}

/* Rotate */
@keyframes rotate{from{transform:rotate(0deg);}to{transform:rotate(360deg);}}
.rotating{animation:rotate 1s linear infinite;}

/* Theme toggle */
#darkModeToggle{position:fixed;top:12px;right:12px;background:var(--panel-bg);border:none;border-radius:20px;
padding:6px 12px;cursor:pointer;color:var(--text-color);font-weight:600;box-shadow:0 2px 8px rgba(0,0,0,0.15);}

/* Mobile */
@media(max-width:600px){
  h1{font-size:38px;}
  .wrap{padding:16px;}
  .btn{font-size:14px;}
}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
</head>
<body>
<button id="darkModeToggle">Light Mode</button>

<div class="wrap">
<h1 id="pageTitle">Text 2 Emoji</h1>
<div class="controls">
  <div class="seg">
    <button id="tab-encrypt" class="active">ğŸ”’ Encrypt Text</button>
    <button id="tab-decrypt">ğŸ”“ Decrypt Emojis</button>
  </div>
</div>

<form id="mainForm" onsubmit="return false;">
  <label id="label-input">1. Type a message</label>
  <textarea id="textInput" placeholder="Hello World or write some javascript code."></textarea>

  <label>2. Set a password</label>
  <input id="password" type="password" placeholder="E.g. My$StrongPass123"/>
  <div class="password-strength"><div id="passwordStrengthBar" class="password-strength-bar"></div></div>
  <div id="strengthText" class="strength-text"></div>

  <label id="label-action">3. Encrypt message</label>
  <button class="btn" id="actionBtn">ğŸ”’ Encrypt Text</button>

  <div class="result" id="resultBox"></div>

  <div style="display:flex;gap:10px;margin-top:10px;flex-wrap:wrap;">
    <button class="copyBtn" id="copyBtn">ğŸ“‹ Copy</button>
    <button class="copyBtn" id="clearBtn">ğŸ§¹ Clear</button>
  </div>

  <div id="err" class="error" style="display:none"></div>
</form>

<div class="share-section">
  <button id="shareWhatsapp" title="Share on WhatsApp"><i class="fab fa-whatsapp"></i></button>
  <button id="shareTwitter" title="Share on Twitter"><i class="fab fa-twitter"></i></button>
  <button id="shareFacebook" title="Share on Facebook"><i class="fab fa-facebook-f"></i></button>
  <button id="shareEmail" title="Email"><i class="fas fa-envelope"></i></button>
</div>
</div>

<footer>Developed By â¤ï¸ Mahmudul Hussain</footer>

<script>
const pageTitle=document.getElementById('pageTitle');
const tabEncrypt=document.getElementById('tab-encrypt'),tabDecrypt=document.getElementById('tab-decrypt');
const actionBtn=document.getElementById('actionBtn'),textInput=document.getElementById('textInput');
const passwordInput=document.getElementById('password'),resultBox=document.getElementById('resultBox');
const copyBtn=document.getElementById('copyBtn'),clearBtn=document.getElementById('clearBtn'),errEl=document.getElementById('err');
const labelInput=document.getElementById('label-input'),labelAction=document.getElementById('label-action');
const strengthBar=document.getElementById('passwordStrengthBar'),strengthText=document.getElementById('strengthText');
let mode='encrypt';

/* Mode switching */
tabEncrypt.onclick=()=>setMode('encrypt');
tabDecrypt.onclick=()=>setMode('decrypt');
function setMode(m){
  mode=m;
  if(m==='encrypt'){
    tabEncrypt.classList.add('active');tabDecrypt.classList.remove('active');
    labelInput.innerText='1. Type a message';
    labelAction.innerText='3. Encrypt message';
    actionBtn.innerText='ğŸ”’ Encrypt Text';
    textInput.placeholder='Hello World or write some javascript code.';
    pageTitle.textContent='Text 2 Emoji';
  } else {
    tabEncrypt.classList.remove('active');tabDecrypt.classList.add('active');
    labelInput.innerText='1. Paste emojis here';
    labelAction.innerText='3. Decrypt emojis';
    actionBtn.innerText='ğŸ”“ Decrypt Emojis';
    textInput.placeholder='Paste the emoji string here to decrypt...';
    pageTitle.textContent='Emoji 2 Text';
  }
  textInput.value='';passwordInput.value='';resultBox.innerText='';
  strengthBar.style.width='0%';strengthText.innerText='';
  clearErrors();
}

/* Error handling */
function clearErrors(){errEl.style.display='none';errEl.innerText='';textInput.classList.remove('error');passwordInput.classList.remove('error');}
function showError(msg){errEl.style.display='block';errEl.innerText=msg;}

/* Password strength */
passwordInput.addEventListener('input',()=>{
  const score=calcStrength(passwordInput.value);
  updateStrengthUI(score);
});
function calcStrength(p){let s=0;if(p.length>=8)s++;if(/[A-Z]/.test(p))s++;if(/[a-z]/.test(p))s++;if(/\d/.test(p))s++;if(/[\W_]/.test(p))s++;return s;}
function updateStrengthUI(score){
  const pct=(score/5)*100;strengthBar.style.width=pct+'%';
  const levels=['Very Weak','Weak','Fair','Good','Strong','Very Strong'];
  const colors=['#ff4d4d','#ff944d','#ffcc00','#99cc00','#00cc66','#00994d'];
  strengthBar.style.backgroundColor=colors[score];strengthText.innerText=levels[score]||'';
}

/* Action button */
actionBtn.onclick=async()=>{
  clearErrors();
  const pwd=passwordInput.value.trim(),input=textInput.value.trim();
  if(!pwd){showError('Please enter a password.');passwordInput.classList.add('error');return;}
  if(!input){showError(mode==='encrypt'?'Please enter a message.':'Please paste emojis.');textInput.classList.add('error');return;}
  actionBtn.disabled=true;actionBtn.classList.add('rotating');
  actionBtn.innerText=mode==='encrypt'?'Encryptingâ€¦':'Decryptingâ€¦';
  try{
    if(mode==='encrypt'){resultBox.innerText=await encryptTextToEmoji(input,pwd);}
    else{resultBox.innerText=await decryptEmojiToText(input,pwd);}
  }catch(e){showError('Operation failed â€” wrong password or corrupted data.');textInput.classList.add('error');}
  actionBtn.classList.remove('rotating');actionBtn.disabled=false;
  actionBtn.innerText=mode==='encrypt'?'ğŸ”’ Encrypt Text':'ğŸ”“ Decrypt Emojis';
};

/* Copy and clear */
copyBtn.onclick=async()=>{
  if(!resultBox.innerText){showError('Nothing to copy.');return;}
  await navigator.clipboard.writeText(resultBox.innerText);
  copyBtn.innerText='Copied âœ…';setTimeout(()=>copyBtn.innerText='ğŸ“‹ Copy',1400);
};
clearBtn.onclick=()=>{textInput.value='';passwordInput.value='';resultBox.innerText='';strengthBar.style.width='0%';strengthText.innerText='';clearErrors();};

/* Share buttons */
function getResultEncoded(){return encodeURIComponent(resultBox.innerText.trim());}
document.getElementById('shareWhatsapp').onclick=()=>{if(!resultBox.innerText)return showError('Nothing to share.');window.open(`https://wa.me/?text=${getResultEncoded()}`,'_blank');};
document.getElementById('shareTwitter').onclick=()=>{if(!resultBox.innerText)return showError('Nothing to share.');window.open(`https://twitter.com/intent/tweet?text=${getResultEncoded()}`,'_blank');};
document.getElementById('shareFacebook').onclick=()=>{if(!resultBox.innerText)return showError('Nothing to share.');window.open(`https://www.facebook.com/sharer/sharer.php?u=https://www.google.com/search?q=${getResultEncoded()}`,'_blank');};
document.getElementById('shareEmail').onclick=()=>{if(!resultBox.innerText)return showError('Nothing to share.');window.location.href=`mailto:?subject=${encodeURIComponent("Encrypted Message")}&body=${getResultEncoded()}`;};

/* Theme toggle */
const darkModeToggle=document.getElementById('darkModeToggle');
darkModeToggle.onclick=()=>{
  document.body.classList.toggle('light');
  darkModeToggle.textContent=document.body.classList.contains('light')?'Dark Mode':'Light Mode';
  localStorage.setItem('theme',document.body.classList.contains('light')?'light':'dark');
};
if(localStorage.getItem('theme')==='light'){document.body.classList.add('light');darkModeToggle.textContent='Dark Mode';}

/* Encryption logic */
const base64Alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
const emojiAlphabet=["ğŸ˜€","ğŸ˜","ğŸ˜‚","ğŸ¤£","ğŸ˜ƒ","ğŸ˜„","ğŸ˜…","ğŸ˜†","ğŸ˜‰","ğŸ˜Š","ğŸ˜‡","ğŸ™‚","ğŸ™ƒ","ğŸ˜","ğŸ¥°","ğŸ˜˜","ğŸ˜—","ğŸ˜™","ğŸ˜š","ğŸ¤—","ğŸ¤©","ğŸ¤”","ğŸ¤¨","ğŸ˜","ğŸ˜‘","ğŸ˜¶","ğŸ˜","ğŸ˜£","ğŸ˜¥","ğŸ˜®","ğŸ¤","ğŸ˜¯","ğŸ˜ª","ğŸ˜«","ğŸ˜´","ğŸ˜Œ","ğŸ˜›","ğŸ˜œ","ğŸ˜","ğŸ¤¤","ğŸ˜’","ğŸ˜“","ğŸ˜”","ğŸ˜•","ğŸ™","â˜¹ï¸","ğŸ˜–","ğŸ˜","ğŸ˜¤","ğŸ˜¢","ğŸ˜­","ğŸ˜¦","ğŸ˜§","ğŸ˜¨","ğŸ˜©","ğŸ¤¯","ğŸ˜¬","ğŸ˜°","ğŸ˜±","ğŸ¥µ","ğŸ¥¶","ğŸ˜³","ğŸ¤ª","ğŸ˜µ","ğŸ¤¡","ğŸ‘»","ğŸ’€"];
const b64ToEmoji={},emojiToB64={};for(let i=0;i<base64Alphabet.length;i++){b64ToEmoji[base64Alphabet[i]]=emojiAlphabet[i];emojiToB64[emojiAlphabet[i]]=base64Alphabet[i];}
function randBytes(len){const b=new Uint8Array(len);crypto.getRandomValues(b);return b;}
async function deriveKeyFromPassword(password,salt){const enc=new TextEncoder();const passKey=await crypto.subtle.importKey('raw',enc.encode(password),'PBKDF2',false,['deriveKey']);return crypto.subtle.deriveKey({name:'PBKDF2',salt:salt,iterations:120000,hash:'SHA-256'},passKey,{name:'AES-GCM',length:256},false,['encrypt','decrypt']);}
function arrayBufferToBase64(buffer){let binary='';const bytes=new Uint8Array(buffer);for(let i=0;i<bytes.length;i+=0x8000){binary+=String.fromCharCode.apply(null,bytes.subarray(i,i+0x8000));}return btoa(binary);}
function base64ToArrayBuffer(base64){const binary=atob(base64);const len=binary.length;const bytes=new Uint8Array(len);for(let i=0;i<len;i++){bytes[i]=binary.charCodeAt(i);}return bytes.buffer;}
function base64ToEmojiString(b64){let out='';for(const ch of b64){out+=b64ToEmoji[ch]||'ï¿½';}return out;}
function emojiStringToBase64(str){let b64='',i=0;while(i<str.length){let matched=false;for(const token of emojiAlphabet.slice().sort((a,b)=>b.length-a.length)){if(str.startsWith(token,i)){b64+=emojiToB64[token];i+=token.length;matched=true;break;}}if(!matched)throw new Error('Invalid emoji');}return b64;}
async function encryptTextToEmoji(plaintext,password){const enc=new TextEncoder();const salt=randBytes(16);const iv=randBytes(12);const key=await deriveKeyFromPassword(password,salt);const ptBytes=enc.encode(plaintext);const cipher=await crypto.subtle.encrypt({name:'AES-GCM',iv:iv},key,ptBytes);const combined=new Uint8Array(salt.length+iv.length+cipher.byteLength);combined.set(salt,0);combined.set(iv,salt.length);combined.set(new Uint8Array(cipher),salt.length+iv.length);return base64ToEmojiString(arrayBufferToBase64(combined.buffer));}
async function decryptEmojiToText(emojiString,password){const b64=emojiStringToBase64(emojiString);const buffer=base64ToArrayBuffer(b64);const all=new Uint8Array(buffer);const salt=all.slice(0,16);const iv=all.slice(16,28);const ciphertext=all.slice(28);const key=await deriveKeyFromPassword(password,salt);const plain=await crypto.subtle.decrypt({name:'AES-GCM',iv:iv},key,ciphertext);return new TextDecoder().decode(plain);}
</script>
</body>
</html>
